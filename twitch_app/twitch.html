<!DOCTYPE html>
<head>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<html>
    
<script>
	
	// Global vars

	var channelNames = ["NoObjectiveGamingAU", "ESL_SC2", "OgamingSC2", "cretetion", "freecodecamp", "storbeck", "habathcx", "RobotCaleb", "noobs2ninjas"];
	//var channelNames = ["OgamingSC2", "NoObjectiveGamingAU"];
	var liveChannels = [];
	var liveChannelNames = [];
	var liveChannelObjects = [];
	var offlineChannelNames = [];
	var streamDetails = [];
	var channelDetails = [];
	var html = "";



	$(document).ready(function () {


		// how about a button to get the status rather than document.ready?
		for (var i = 0; i < channelNames.length;i++) {
			
			$.getJSON('https://wind-bow.glitch.me/twitch-api/streams/' + channelNames[i], function(streamData) {
				
				streamDetails.push(streamData);
				
			});
			
			$.getJSON('https://wind-bow.glitch.me/twitch-api/channels/' + channelNames[i], function(channelData) {
				
				channelDetails.push(channelData);
			});
		}
		
		$("#getMessage").on("click", function() {
			
			// These are the live channels, but it contains all the data
			liveChannels = streamDetails.filter(function(channel){
				return(channel.stream != null);
			});
			
			// Attempting to create objects for each live channel
			for (var i = 0; i < liveChannels.length; i++){
				liveChannelNames.push(liveChannels[i].stream.channel.display_name) // this is what I was doing to get the live channel to an array
				var liveObject = { //consider calling it something like liveChannel1, 2, 3...
					"Name": liveChannels[i].stream.channel.display_name,
					"logo": liveChannels[i].stream.channel.logo,
					"link": liveChannels[i].stream.channel.url,
					"viewers": liveChannels[i].stream.viewers
				}
				liveChannelObjects.push(liveObject);
			}
			console.log(liveChannelObjects);

			// return the channels that are not live and add them to the array offlineChannelNames
			for (var i = 0; i < liveChannelNames.length; i++){
				
				for (var j = 0; j < channelNames.length; j++){
					if (liveChannelNames[i] == channelNames[j]){
						var shift = channelNames.shift()
						offlineChannelNames.push(shift);
					} else {
						var shift = channelNames.shift();
						channelNames.push(shift);
					}
				}

				// offlineChannelNames = channelNames.filter(function(val){
				// 	return(val != liveChannelNames[i]);
				// });
				
			}
			
		
			
			console.log("All channels: " + channelNames);
			console.log("offline channels: " + offlineChannelNames)
			//console.log(streamDetails);
			//console.log(channelDetails);
			console.log("live channels: " + liveChannelNames);

			// Cycle Live channels through stream details for the following pices:
			// - icon
			// - Display name as a hyperlink
			// - viewers <-- only stream detail can provide
			// Need this to cycle through, then pull out the piece that matches
			// Thinking shift / push if not a match, shift only when matches
			// Need to cycle through all of the channels... unless a better idea comes along
			// what about creating objects?
			/* for (var i = 0; i < streamDetails.length; i++) {
				if ()

			} */
			
			html += "<div class='streamer'>"
			$("#message").html(liveChannelObjects[0]);
			//$("#message").html("Live Channels: " + offlineChannelNames);
		
		
		});
			
		
		/* $("#getMessage").on("click", function() {
			
			html = "";
			
			

			for (var i = 0; i < channelNames.length; i++) {
				
				
				$.getJSON('https://wind-bow.glitch.me/twitch-api/streams/' + channelNames[i], function(streamData) {

					console.log(streamData);

					if (streamData.stream != null) {	
						html += "<div class='streamer'>"
						html += "<img src= '" + streamData.stream.channel.logo + "'" + "height='50' width='50'>";
						html += "<p>" + streamData.stream.channel.display_name + "</p>";
						html += "<p>Viewers: " + streamData.stream.viewers + "</p>";
						if (streamData.stream.channel.mature == true) {
							html += "<p>Mature Channel: yes</p>";
						} else {
							html += "<p>Mature Channel: no</p>";
						}
						html += "<a href='" + streamData.stream.channel.url + "'>" + streamData.stream.channel.status + "</a>";
						html += "<p>Live now!</p>";
						html += "</div>";

						$("#message").html(html);
				
					} else {
						//alert(i);
						//alert(channelNames[i]);
						$.getJSON('https://wind-bow.glitch.me/twitch-api/channels/' + channelNames[i], function(channelData) {
							html += "<div class='streamer'>"
							html += "<img src= '" + channelData.logo + "'" + "height='50' width='50'>";
							html += "<p>" + channelData.display_name + "</p>";
							html += "<p>Offline</p>"
							html += "<p>Followers: " + channelData.followers + "</p>";
							$("#message").html(html);
						});
					}		
				
				});
			};
		}); */
	});

</script>

    <body>
        
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-6 col-md-offset-3" style="text-align: center">
                    
                    <p id="message" class="well">This is where the message goes</p>
					<button id="getMessage" class="btn btn-primary">CLICK MEH</button>
					<button id="getOnline" class="btn btn-primary">NO CLICK MEH</button>

                </div>
            </div>
        </div>


    </body>


</html>



<style>
	.streamer {
		color: black;
		text-align: left;
	}
</style>