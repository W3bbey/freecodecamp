<!DOCTYPE html>
<head>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">

</head>

<html>
<body>
    
	
	<div class="container">
		
		<div class="row col-md-6 col-md-offset-3" style="text-align: center; margin-top: 20px;	">
			<input id="wikiQuery" type="text" name="search">
			<!-- <button type="submit" class="btn btn-primary">Submit</button> -->

		    	<button id="getQuery" class="btn btn-primary" type="submit" value="submit">Search</button>
		    

		    	<p>Links below:</p>
		    	<p id="linksInHtml"></p>
		</div>
	</div>


</body>
</html>


<script>

$(document).ready(function() {

    // Global vars defined here
    var mainSearch = "";
    var pageIdentifier = "";
    var title = "";
    var output = document.getElementById("links");
    var wikiObjects = [];
    var baseLink = "http://en.wikipedia.org/?curid=";
    var searchLinks = "";
    var clickableLinks = "";


    // This function accepts the search result of the text entered into the submit field and assigns it to "mainSearch"
    // mainSearch is called in the meaty function below it.
    function getSubmit() {
        mainSearch = document.getElementById("wikiQuery").value;
    }

    // This function is meant to clear the search history
    function clearLinksInHtml() {
        //$("#linksInHtml").html(clickableLinks);
        clickableLinks = ""; // I don't believe this is needed anymore
        document.getElementById("linksInHtml").innerHTML = "";
    }

    function startSearch() {
        // clear any previous search
        // clearLinksInHtml();
                
        // get the value from the submit field
        getSubmit();
        
        // Query the API with the contents of the search field
        $.getJSON("https://en.wikipedia.org/w/api.php?action=query&format=json&origin=*&list=search&utf8=1&srsearch=" + mainSearch/* include search here */, function(json){
            
            // title is useful to create a clean hyperlink
            title = json.query.search[0].title;
            
            // This for loop is intended to push each of the Page IDs to the wikiObjects array
            // I'd like to push out a link for each of the 10 results.    
            for (var i = 0; i < 10; i++) {
                pageIdentifier = json.query.search[i].pageid;
                searchLinks = baseLink.concat(pageIdentifier);
                wikiObjects.push(searchLinks);
                clickableLinks += "<a href=" + wikiObjects[i] + ">" + wikiObjects[i] + "</a>" + "<br>";
            }

            $("#linksInHtml").html(clickableLinks);
            
            clickableLinks = ""; // Setting this to an empty variable prevents text from accumulating
            mainSearch = "";
            //console.log(wikiObjects);
            
        });
    }


    // Accept a keypress of ENTER
    $("#wikiQuery").keypress(function(e) {
        
        var key = e.which;
        if (key == 13) {
            $('input[name=butAssignProd]').click();
            startSearch();
            console.log("you entered!");
        }
        
    });
    
    // Accept clicking the submit button
    $("#getQuery").on("click", function(){
        
        startSearch();
        console.log("You clicked!");
            
    });    
});

</script>


<style>
</style>
